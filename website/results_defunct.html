<!DOCTYPE html>
<html lang="en">

  <head>

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="">
    <meta name="author" content="">


    <title>CMSC447 Project</title>

 <link rel="stylesheet" type="text/css" href="stylesheet.css" media="screen" />
    <!-- Bootstrap core CSS -->
    <link href="vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">

  </head>

  <body>

    <!-- Navigation -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark fixed-top">
        <div class="container">
            
            <img src="flyingmongoose.png" alt="FinghtingMongooses" width=60px height = 50px>
            </img>
            
            <a class="navbar-brand" href="#">Fighting Mongooses</a>
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarResponsive" aria-controls="navbarResponsive" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>
            <div class="collapse navbar-collapse" id="navbarResponsive">
                <ul class="navbar-nav ml-auto">
                    <li class="nav-item active">
                        <a class="nav-link" href="index.html">Query
                            <span class="sr-only">(current)</span>
                        </a>
                    </li>
                        
                    <li class="nav-item">
                        <a class="nav-link" href="results.html">Result</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="about.html">About</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <!-- Page Content -->
 
        <table width=100% height=100%>
            <br>
            <td id="map"></td>
            
            <script>
            var map;
            var usa = {lat: 37.0979817, lng: -98.9600287};
            function initMap() {
                map = new google.maps.Map(document.getElementById('map'), {
                    center: usa,
                    zoom: 4
                });
            }
            </script>
          
          <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBhOR2E6G3t8nrOqDF6WkgKEueL8YykS0c&callback=initMap"
              async defer></script>
            
            <td id="result_right">
            <form align="left" width=100% height=100%>
                <select size="34" style="width:100%" "height:100%">
                    <option value="1">City, State, Pop Temp pop</option>
                    <option value="2">City, State, Pop Temp pop</option>
                    <option value="3">City, State, Pop Temp pop</option>
                    <option value="4">City, State, Pop Temp pop</option>
                    <option value="1">City, State, Pop Temp pop</option>
                    <option value="2">City, State, Pop Temp pop</option>
                    <option value="3">City, State, Pop Temp pop</option>
                    <option value="4">City, State, Pop Temp pop</option>
                    <option value="1">City, State, Pop Temp pop</option>
                    <option value="2">City, State, Pop Temp pop</option>
                    <option value="3">City, State, Pop Temp pop</option>
                    <option value="4">City, State, Pop Temp pop</option>
                    <option value="1">City, State, Pop Temp pop</option>
                    <option value="2">City, State, Pop Temp pop</option>
                    <option value="3">City, State, Pop Temp pop</option>
                    <option value="4">City, State, Pop Temp pop</option>
                    <option value="1">City, State, Pop Temp pop</option>
                    <option value="2">City, State, Pop Temp pop</option>
                    <option value="3">City, State, Pop Temp pop</option>
                    <option value="4">City, State, Pop Temp pop</option>
                    <option value="1">City, State, Pop Temp pop</option>
                    <option value="2">City, State, Pop Temp pop</option>
                    <option value="3">City, State, Pop Temp pop</option>
                    <option value="4">City, State, Pop Temp pop</option>
                    <option value="1">City, State, Pop Temp pop</option>
                    <option value="2">City, State, Pop Temp pop</option>
                    <option value="3">City, State, Pop Temp pop</option>
                    <option value="4">City, State, Pop Temp pop</option>
                    <option value="1">City, State, Pop Temp pop</option>
                    <option value="2">City, State, Pop Temp pop</option>
                    <option value="3">City, State, Pop Temp pop</option>
                    <option value="4">City, State, Pop Temp pop</option>
                    <option value="1">City, State, Pop Temp pop</option>
                    <option value="2">City, State, Pop Temp pop</option>
                    <option value="3">City, State, Pop Temp pop</option>
                    <option value="4">City, State, Pop Temp pop</option>
                    <option value="1">City, State, Pop Temp pop</option>
                    <option value="2">City, State, Pop Temp pop</option>
                    <option value="3">City, State, Pop Temp pop</option>
                    <option value="4">City, State, Pop Temp pop</option>
                    <option value="1">City, State, Pop Temp pop</option>
                    <option value="2">City, State, Pop Temp pop</option>
                    <option value="3">City, State, Pop Temp pop</option>
                    <option value="4">City, State, Pop Temp pop</option>
                    <option value="1">City, State, Pop Temp pop</option>
                    <option value="2">City, State, Pop Temp pop</option>
                    <option value="3">City, State, Pop Temp pop</option>
                    <option value="4">City, State, Pop Temp pop</option>
                    <option value="1">City, State, Pop Temp pop</option>
                    <option value="2">City, State, Pop Temp pop</option>
                    <option value="3">City, State, Pop Temp pop</option>
                    <option value="4">City, State, Pop Temp pop</option>
                    <option value="1">City, State, Pop Temp pop</option>
                    <option value="2">City, State, Pop Temp pop</option>
                    <option value="3">City, State, Pop Temp pop</option>
                    <option value="4">City, State, Pop Temp pop</option>
                    <option value="1">City, State, Pop Temp pop</option>
                    <option value="2">City, State, Pop Temp pop</option>
                    <option value="3">City, State, Pop Temp pop</option>
                    <option value="4">City, State, Pop Temp pop</option>
                    <option value="1">City, State, Pop Temp pop</option>
                    <option value="2">City, State, Pop Temp pop</option>
                    <option value="3">City, State, Pop Temp pop</option>
                    <option value="4">City, State, Pop Temp pop</option>
                    <option value="1">City, State, Pop Temp pop</option>
                    <option value="2">City, State, Pop Temp pop</option>
                    <option value="3">City, State, Pop Temp pop</option>
                    <option value="4">City, State, Pop Temp pop</option>
                    <option value="1">City, State, Pop Temp pop</option>
                    <option value="2">City, State, Pop Temp pop</option>
                    <option value="3">City, State, Pop Temp pop</option>
                    <option value="4">City, State, Pop Temp pop</option>
                    <option value="1">City, State, Pop Temp pop</option>
                    <option value="2">City, State, Pop Temp pop</option>
                    <option value="3">City, State, Pop Temp pop</option>
                    <option value="4">City, State, Pop Temp pop</option>
                    <option value="1">City, State, Pop Temp pop</option>
                    <option value="2">City, State, Pop Temp pop</option>
                    <option value="3">City, State, Pop Temp pop</option>
                    <option value="4">City, State, Pop Temp pop</option>
                    
                    
                </select>
            </form>
            </td>
            
            <td id="result_left">
            <div id="query" align="right">
            <form align="middle" width=100% height=100%>
                
                City Population:
                <br>
                <input type="text" name="query_pop_min" id="query_pop_min" placeholder="Min" size=4> −
                  
                <input type="text" name="query_pop_max" id="query_pop_max" placeholder="Max" size=4>
                        
                <br>
                <br>
                        
                Average Property Values: ($)<span id="display_property">
                <br>
                <input type="text" name="query_prop_min" id="query_prop_min" placeholder="Min" size=4> −
                <input type="text" name="query_prop_max" id="query_prop_max" placeholder="Max" size=4>
                                    
                <br>
                <br>
                                    
                Average temperature range: (°F)
                <br>
                <input type="text" name="query_temp_min" id="query_temp_min" placeholder="Min" size=4> −
                <input type="text" name="query_temp_max" id="query_temp_max" placeholder="Max" size=4>
                                            
                <br>
                <br>
                                            
                Average number of sunny days:
                <br>
                <input type="text" name="query_sun_min" id="query_sun_min" placeholder="Min" size=4> −
                <input type="text" name="query_sun_max" id="query_sun_max" placeholder="Max" size=4>
                                                    
                <br>
                <br>
                
                Average humidity: (%)
                <br>
                <input type="text" name="query_humid_min" id="query_humid_min" placeholder="Min" size=4> −
                <input type="text" name="query_humid_max" id="query_humid_max" placeholder="Max" size=4>
                    
                <br>
                <br>
                                                            
                Average rainfall: (in)
                <br>
                <input type="text" name="query_rain_min" id="query_rain_min" placeholder="Min" size=4> −
                <input type="text" name="query_rain_max" id="query_rain_max" placeholder="Max" size=4>
                                                                    
                <br>
                <br>
                                                                    
                Average snowfall: (in)
                <br>
                <input type="text" name="query_snow_min" id="query_snow_min" placeholder="Min" size=4> −
                <input type="text" name="query_snow_max" id="query_snow_max" placeholder="Max" size=4>
                                                                            
                <br>
                <br>
                                                                            
                Political Color:
                <br>
                <form action="">
                <label for="query_color_blue" style="color:blue;"><input type="checkbox" name="query_color_blue" id="query_color_blue" value="blue">Blue</label>
                <label for="query_color_red" style="color:red;"><input type="checkbox" name="query_color_red" id="query_color_red" value="red">Red</label>
                </form>
                                                                            
                <br>
                <br>
                <button type="button" onclick="handleSubmit()">Submit</button>
                                                                            
                <script type="text/javascript">
                    function handleSubmit() {
                    var param_color_red_t = (document.getElementById("query_color_red").checked && !document.getElementById("query_color_blue").checked) ? "red" : ""
                    var param_color_blue_t = (document.getElementById("query_color_blue").checked && !document.getElementById("query_color_red").checked) ? "blue" : ""
                                                                                    
                    $.ajax({
                        url: "/getPoints",
                        //make an AJAX request to the py script
                        type: "POST",
                        //pass query params below
                                                                                           
                        data: {
                           param_pop_min : document.getElementById("query_pop_min").value,
                           param_pop_max : document.getElementById("query_pop_max").value,
                           param_prop_min : document.getElementById("query_prop_min").value,
                           param_prop_max : document.getElementById("query_prop_max").value,
                           param_temp_min : document.getElementById("query_temp_min").value,
                           param_temp_max : document.getElementById("query_temp_max").value,
                           param_sun_min : document.getElementById("query_sun_min").value,
                           param_sun_max : document.getElementById("query_sun_max").value,
                           param_humid_min : document.getElementById("query_humid_min").value,
                           param_humid_max : document.getElementById("query_humid_max").value,
                           param_rain_min : document.getElementById("query_rain_min").value,
                           param_rain_max : document.getElementById("query_rain_max").value,
                           param_snow_min : document.getElementById("query_snow_min").value,
                           param_snow_max : document.getElementById("query_snow_max").value,
                           
                           param_color_red : param_color_red_t,
                           param_color_blue : param_color_blue_t
                           },
                           
                           success: callbackFunc
                        });
                    }
                                                                            
                    // the smooth zoom function
                    
                    function smoothZoom (map, max, cnt) {
                    if (cnt >= max) {
                        return;
                    }
                    else {
                        z = google.maps.event.addListener(map, 'zoom_changed', function(event){
                                                          
                        google.maps.event.removeListener(z);
                        smoothZoom(map, max, cnt + 1);
                        });
                    
                        // 80ms is what I found to work well on my system -- it might not work well on all systems
                        setTimeout(function(){map.setZoom(cnt)}, 80);
                    }
                }
                                                                            
                function callbackFunc(response) {
                    //handle response here
                    //console.log(response);
                    var positions = JSON.parse(response);
                                                                                
                    positions.forEach(function(element) {
                        console.log(element[0]);
                        console.log(element[1]);
                        var marker = new google.maps.Marker({
                        
                            position: {lat: element[1][0], lng: element[1][1]},
                            map: map
                        });
                    });
                var firstPos = {lat: positions[0][1][0], lng: positions[0][1][1]};
                //var newOptions = {'zoom':13, 'center':firstPos};
                //map.setOptions(newOptions);
                map.panTo(firstPos);
                smoothZoom(map, 9, map.getZoom());
                                                                                                  
                }
                </script>
                </form>
            </div>
        </td>

        <td id="result_bottom">
              <br>
              &#169; 2018 &bull; Fighting Mongooses &bull; Software Engineering &bull; University of Maryland, Baltimore County USA
               
          </td>
          
          
        </table>
        
      
        <!-- DivTable.com -->



    <!-- Bootstrap core JavaScript -->
    <script src="vendor/jquery/jquery.min.js"></script>
    <script src="vendor/bootstrap/js/bootstrap.bundle.min.js"></script>

    <script src="script.js" type="text/javascript"></script>
  </body>

</html>
